// ×£ÄúÆ½°² ¸èÇú

#include<reg52.h>
unsigned char Count;

sbit _Speak=P1^6;
unsigned char code SONG[]={
0x26,0x20,0x20,0x20,0x20,0x20,0x26,0x10, 0x20,0x10,0x20,0x80,    

0x26,0x20,0x30,0x20,

0x30,0x20,0x39,0x10,0x30,0x10,0x30,0x80, 0x26,0x20,0x20,0x20,    

0x20,0x20,0x1c,0x20,

0x20,0x80,0x2b,0x20,0x26,0x20,0x20,0x20, 0x2b,0x10,0x26,0x10,    

0x2b,0x80,0x26,0x20,

0x30,0x20,0x30,0x20,0x39,0x10,0x26,0x10, 0x26,0x60,0x40,0x10,    

0x39,0x10,0x26,0x10,

0x30,0x20,0x30,0x20,0x39,0x10,0x26,0x10, 0x26,0x80,0x26,0x20,    

0x2b,0x10,0x2b,0x10,

0x2b,0x20,0x30,0x10,0x39,0x10,0x26,0x10, 0x2b,0x10,0x2b,0x20,    

0x2b,0x40,0x40,0x20,

0x20,0x10,0x20,0x10,0x2b,0x10,0x26,0x30, 0x30,0x80,0x18,0x20,    

0x18,0x20,0x26,0x20,

0x20,0x20,0x20,0x40,0x26,0x20,0x2b,0x20, 0x30,0x20,0x30,0x20,    

0x1c,0x20,0x20,0x20,

0x20,0x80,0x1c,0x20,0x1c,0x20,0x1c,0x20, 0x30,0x20,0x30,0x60,    

0x39,0x10,0x30,0x20,


};
void Time0_Init()
{ 
  TMOD = 0x01;
  IE = 0x82;
  TH0 = 0xD8;
  TL0 =0xEF ;
}
  void Time0_Int() interrupt 1
     {
      TH0 = 0xD8;
      TL0 = 0xEF;
      Count++;
      }
void Delay_xMs(unsigned int x)
{
  unsigned int i,j;
  for (i=0;i<x;i++)
   {
    for(j=0;j<3;j++);
   }
}
void Play_Song(unsigned char i)
{
  unsigned char Temp1,Temp2;
  unsigned int Addr;
  Count = 0;
  Addr=i*217;
  while(1)
   {
   Temp1 = SONG[Addr++];
   if ( Temp1 == 0xFF)
     {
    TR0 = 0;
    Delay_xMs(100);
}
   else if ( Temp1 == 0x00)
   {
    return;}
   else
    {
       Temp2 = SONG[Addr++];
       TR0 = 1;
       while(1)
     {
      _Speak=~_Speak;
      Delay_xMs(Temp1);
      if(Temp2 == Count)
     {
      Count = 0;
     break;
     }
    }
   }
  }
 }
 
 void main()
{
   Time0_Init();
   while(1)
 {
   Play_Song(0);
 }
}
